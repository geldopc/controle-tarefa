<ion-content>
<cabecalho></cabecalho>
<div class="container-fluid principal">
    <br/>
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3">
                        <span>Ocorrências {{painel}}</span>
                    </div>
                    <div class="col-md-3 col-lg-3 hidden-xs hidden-sm">
                        <input type="text" class="form-control" placeholder="Pesquisar..." [(ngModel)]="filtrosPesquisaTecnico.dsPesq" (keyup)="filtrosPesquisaTecnico.filtrarDescricao($event, grid); "
                        />
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-6 hidden-xs hidden-sm">
                        <input type="date"
                            class="form-control pull-left"
                            placeholder="De"
                            [(ngModel)]="filtrosPesquisaTecnico.dtInicio"
                            style="width: 35%; margin: 0 2px 0 2px;"/>
                        <input type="date"
                            class="form-control pull-left"
                            placeholder="Até"
                            [(ngModel)]="filtrosPesquisaTecnico.dtFim"
                            style="width: 35%; margin: 0 2px 0 2px;"/>
                        <button type="button" class="btn btn-default pull-right" (click)="filtrosPesquisaTecnico.limparFiltros(grid);" style="width: 10%; margin: 0 2px 0 2px;">
                            <i class="fa fa-close"></i>
                        </button>
                        <button type="button" class="btn btn-default pull-right" (click)="filtrosPesquisaTecnico.filtrarData(grid);" style="width: 10%; margin: 0 2px 0 2px;">
                            <i class="fa fa-search"></i>
                        </button>
                        <!-- <button type="button" class="btn btn-default pull-right activated" (click)="mudarButton($event)" style="width: 10%; margin: 0 2px 0 2px;">
                            <i class="{{fafa}}"></i>
                        </button> -->
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                            <!-- <div class="row">
                                <div class="col-xs-12 col-sm-12 hidden-md hidden-lg">
                                    <label for="pesquisar">Pesquisa Rápida:</label>
                                    <input id="pesquisar" type="text" class="form-control" placeholder="Pesquisar..." [(ngModel)]="filtrosPesquisaTecnico.dsPesq"
                                        (keyup)="filtrosPesquisaTecnico.filtrarDescricao($event, grid);" />
                                </div>
                                <div class="col-xs-6 col-sm-6 hidden-md hidden-lg">
                                    <label for="pesquisar">Data inicial:</label>
                                    <input type="date" class="form-control pull-left" placeholder="De" value="{{filtrosPesquisaTecnico.dtInicio}}" [(ngModel)]="filtrosPesquisaTecnico.dtInicio" />
                                </div>
                                <div class="col-xs-6 col-sm-6 hidden-md hidden-lg">
                                    <label for="pesquisar">Data Final:</label>
                                    <input type="date" class="form-control pull-left" placeholder="Até" value="{{filtrosPesquisaTecnico.dtFim}}" [(ngModel)]="filtrosPesquisaTecnico.dtFim" />
                                </div>
                                <div class="col-xs-6 col-sm-6 hidden-md hidden-lg">
                                    <button type="button" class="btn btn-default btn-block btn-margin" (click)="filtrosPesquisaTecnico.limparFiltros(grid);">
                                        <i class="fa fa-close"></i>
                                    </button>
                                </div>
                                <div class="col-xs-6 col-sm-6 hidden-md hidden-lg">
                                    <button type="button" class="btn btn-default btn-block btn-margin" (click)="filtrosPesquisaTecnico.filtrarData(grid);">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div> -->

                            <ul class="nav nav-pills nav-justified">
                                <li class="active">
                                    <a data-toggle="pill" href="#homeFiltros">Filtros</a>
                                </li>
                                <li>
                                    <a data-toggle="pill" href="#menuDados">Detalhes</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div id="homeFiltros" class="tab-pane fade in active">
                                    <!-- <div *ngIf="exibeFiltros == true"> -->
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                            <filtros-pesquisa-tecnico
                                                (ChamadosTempChange)="WhateverOcorrencia($event)"
                                                (gridOcorrenciasTecnicoTempChange)="atualizarGrid($event)"
                                                (filtrosChange)=retornarFiltros($event)
                                                [dtInicio]="dtInicio"
                                                [dtFim]="dtFim">
                                            </filtros-pesquisa-tecnico>
                                        </div>
                                    </div>
                                    <!-- </div> -->
                                    <!-- <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                        <ul class="nav nav-tabs nav-justified">
                                            <li class="active"><a data-toggle="pill" href="#totalModalidade">Total</a></li>
                                        </ul>
                                        <div class="tab-content">
                                            <div id="totalModalidade" class="tab-pane fade in active">
                                                <div class="row">
                                                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                                        <div class="progress">
                                                            <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" aria-valuenow="16"
                                                                aria-valuemin="0" aria-valuemax="100" [style.width]="0">
                                                                <span class="sr-only"> Complete</span>
                                                            </div>
                                                            <span class="progress-type">Ocorrências:</span>
                                                            <span class="progress-completed"> {{totalOcorrencias ?
                                                                    totalOcorrencias : 0}}</span>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                                        <div class="progress">
                                                            <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" aria-valuenow="138"
                                                                aria-valuemin="0" aria-valuemax="100" [style.width]="0">
                                                                <span class="sr-only"> Complete (danger)</span>
                                                            </div>
                                                            <span class="progress-type">Tarefas:</span>
                                                            <span class="progress-completed">{{totalDistribuicao ? totalDistribuicao : 0}}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>

                                <div id="menuDados" class="tab-pane fade">
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                            <!-- <div *ngIf="exibeDados == true"> -->
                                            <painel-visualizacao-ocorrencias
                                                [ocorrencias]="filtrosPesquisaTecnico.chamadosTemp"
                                                (totalDistribuicaoChange)="totalDistribuicao = $event"
                                                (totalOcorrenciasChange)="totalOcorrencias = $event"
                                                [filtros]="filtrosPesquisaTecnico.filtros">
                                            </painel-visualizacao-ocorrencias>
                                            <!-- </div> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-primary" (click)="pesquisaWS();">
                                        <i class="fa fa-search"></i>&nbsp;Pesquisar
                                    </button>
                                </div>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-default" (click)="filtrosPesquisaTecnico.limparFiltros(grid);">
                                        <i class="fa fa-times"></i>&nbsp;Limpar filtros
                                    </button>
                                </div>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modalNovaOcorrencia"
                                        (click)="novaOcorrencia();">
                                        <i class="fa fa-plus"></i>&nbsp;Nova Ocorrência
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-default">
                                        Ocorrências
                                        <!-- <span class="badge">{{totalOcorrencias ? totalOcorrencias.toLocaleString() : 0}}</span> -->
                                        <span class="badge">{{filtrosPesquisaTecnico.chamadosTemp ? filtrosPesquisaTecnico.chamadosTemp.length.toLocaleString() : 0}}</span>
                                    </button>
                                </div>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-default">
                                        Tarefas
                                        <span class="badge">{{totalDistribuicao ? totalDistribuicao.toLocaleString() : 0}}</span>
                                    </button>
                                </div>
                            </div>
                            <!-- <span class="label label-danger">
                                Ocorrências
                                <span class="badge">{{totalOcorrencias ? totalOcorrencias : 0}}</span>
                            </span>
                            <span class="label label-warning">
                                Tarefas
                                <span class="badge">{{totalDistribuicao ? totalDistribuicao : 0}}</span>
                            </span> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <grid-ocorrencias-tecnico *ngIf="chamadosResponse"
                [chamadosTemp]="filtrosPesquisaTecnico.chamadosTemp"
                [filtros]="filtrosPesquisaTecnico.filtros"
                [filtrosPesquisaTecnico]="filtrosPesquisaTecnico"
                (reCarregarGridChange)="filtrosPesquisaTecnico.pesquisarWS(grid)">
            </grid-ocorrencias-tecnico>
            <lista-atualizacao-de-versao>
            </lista-atualizacao-de-versao>
            <br/>
            <br/>
            <br/>
        </div>
    </div>
</div>
<!-- Modal Nova Ocorrência -->
<div class="modal fade" id="modalNovaOcorrencia" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="background-color:  rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Cadastrar Ocorrência Interna</h4>
            </div>
            <div class="modal-body">
                <!-- <ul class="nav nav-pills">
                    <li id="tabCadastro" class="active">
                        <a data-toggle="pill" href="#tabBodyCadastro" (click)="isTabDistribuicao = false;">Cadastro</a>
                    </li>
                </ul> -->
                <div class="tab-content">
                    <br/>
                    <div id="tabBodyCadastro" class="tab-pane fade in active">
                        <div class="row form-group">
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" *ngIf="filtrosPesquisaTecnico.filtros.produto">
                                <label for="produto">Produto:
                                    <span class="required-message">*&nbsp;{{filtrosPesquisaTecnico.reqMsgProd}}</span>
                                </label>
                                <div class="dropdown">
                                    <button id="produto" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                        {{filtrosPesquisaTecnico.filtros.produto.show}}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li *ngFor="let key of filtrosPesquisaTecnico.filtros.produtos;">
                                            <a (click)="filtrosPesquisaTecnico.filtros.produto = key; filtrosPesquisaTecnico.setProdutoFiltro(key);">
                                                {{key.show}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" *ngIf="filtrosPesquisaTecnico.filtros.tipoOcorrencia">
                                <label for="tipoOcorrencia">Funcionalidade:
                                    <span class="required-message">*&nbsp;{{filtrosPesquisaTecnico.reqMsgTipo}}</span>
                                </label>
                                <div class="dropdown">
                                    <button id="tipoOcorrencia" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                        {{filtrosPesquisaTecnico.filtros.tipoOcorrencia.show}}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu scrollable-menu">
                                        <li *ngFor="let key of filtrosPesquisaTecnico.filtros.tiposOcorrencia;">
                                            <a (click)="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.cdFuncionalidade = key.select; filtrosPesquisaTecnico.filtros.tipoOcorrencia = key;">
                                                {{key.show}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" *ngIf="filtrosPesquisaTecnico.filtros.cliente">
                                <label for="cliente">Cliente:
                                    <span class="required-message">*&nbsp;{{filtrosPesquisaTecnico.reqMsgCliente}}</span>
                                </label>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle form-control" type="button" id="homologador" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                        {{filtrosPesquisaTecnico.filtros.cliente.show}}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li *ngFor="let item of filtrosPesquisaTecnico.filtros.clientes;">
                                            <a (click)="filtrosPesquisaTecnico.setClienteFiltro(item); obterSolicitante(item.select)">
                                                {{item.show}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                                <label>
                                    Solicitante
                                </label>
                                <div class="btn-group btn-block">
                                    <button type="button"
                                        class="btn btn-default btn-block dropdown-toggle"
                                        data-toggle="dropdown"
                                        aria-haspopup="true"
                                        aria-expanded="false">
                                        <div class="label-combo">
                                            {{solicitante?.nome}}
                                        </div>
                                        <div class="pull-right">
                                            <span class="caret"></span>
                                        </div>
                                    </button>
                                    <ul class="dropdown-menu scrollable-menu">
                                        <li *ngFor="let item of solicitantes;">
                                            <a (click)="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.cdUsuarioSolicitante = item.nrDocumento; solicitante = item;">
                                                {{item.nome}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <!-- <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" *ngIf="isSm">

                                <div class="checkbox">
                                    <label>
                                        <input class="btn" type="checkbox" [(ngModel)]="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.replicacaoSiapec1" /> <b>Replicação SIAPEC1:</b>
                                    </label>
                                </div>
                            </div> -->
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                                <strong>Replicação SIAPEC1:</strong>
                                <label class="switch">
                                    <input type="checkbox" [(ngModel)]="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.replicacaoSiapec1">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        <!-- <div class="row form-group">
                            <div class="col-xs-12 col-sm-12  col-md-6 col-lg-6">
                                <label for="solicitadoCliente">Ocorrência interna?
                                    <span>{{reqMsgSolicitado}}</span>
                                    <span class="required-message">*&nbsp;</span>
                                </label>
                                <div class="dropdown">
                                    <button id="solicitadoCliente" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown"
                                        aria-haspopup="true" aria-expanded="true">
                                        <span *ngIf="ocorrenciaGsm.inOcorrenciaInterna == true"> Sim</span>
                                        <span *ngIf="ocorrenciaGsm.inOcorrenciaInterna == false"> Não</span>
                                        <span *ngIf="ocorrenciaGsm.inOcorrenciaInterna == null"> Todos</span>
                                        <span class="caret"></span>
                                    </button>

                                    <ul class="dropdown-menu">
                                        <li *ngFor="let item of simNao;">
                                            <a (click)="ocorrenciaGsm.inOcorrenciaInterna = item.select ">
                                                {{item.show}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div> -->
                        <div class="row form-group">
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" *ngIf="filtrosPesquisaTecnico.filtros.ocorrenciaGsm">
                                <div class="form-group">
                                    <label for="descricaoOrorrencia">Descrição:
                                        <span class="required-message">*&nbsp;{{filtrosPesquisaTecnico.reqMsgDesc}}</span>
                                    </label>
                                    <!-- <textarea id="descricaoOrorrencia" class="form-control" rows="10" maxlength="500" placeholder="Escreva Aqui..." [(ngModel)]="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.dsOcorrencia">
                                    </textarea> -->
                                    <angular-editor placeholder="Descreva aqui o problema..." [config]="editorConfig" [(ngModel)]="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.dsOcorrencia"></angular-editor>
                                    <span>{{filtrosPesquisaTecnico.filtros.ocorrenciaGsm.dsOcorrencia?.length}}/500</span>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                <span class="btn btn-default btn-file btn-block">
                                    <i class="fa fa-paperclip"></i>&nbsp;Adicionar Anexo
                                    <input type="file" name="img" class="form-control" (change)="lerUrlImagem($event);">
                                    <span class="badge" *ngIf="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.anexos">{{filtrosPesquisaTecnico.filtros.ocorrenciaGsm.anexos.length}}</span>
                                </span>
                            </div>
                            <hr>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                <div class="row">
                                    <div *ngFor="let anexo of filtrosPesquisaTecnico.filtros.ocorrenciaGsm.anexos; let index = index;" class="col-xs-2 col-sm-2 col-md-1 col-lg-1"
                                        style="min-height: 50px;">
                                        <span *ngIf="anexo.dsExtensao === 'png' || anexo.dsExtensao === 'jpg' || anexo.dsExtensao === 'jpeg' || anexo.dsExtensao === 'gif'" (click)="preRemove(index);"
                                            class="fa-stack fa-md" style="color: #ffd54f;" title="{{anexo.dsNome}}" data-toggle="tooltip">
                                            <i class="fa fa-file-image-o fa-3x"></i>
                                            <i class="fa fa-times fa-stack-1x icon-remove"></i>
                                        </span>
                                        <span *ngIf="anexo.dsExtensao === 'pdf'" (click)="preRemove(index);" class="fa-stack fa-md" style="color: #e57373;" title="{{anexo.dsNome}}"
                                            data-toggle="tooltip">
                                            <i class="fa fa-file-pdf-o fa-3x"></i>
                                            <i class="fa fa-times fa-stack-1x icon-remove"></i>
                                        </span>
                                        <span *ngIf="anexo.dsExtensao === 'xls' || anexo.dsExtensao === 'xlsx' || anexo.dsExtensao === 'xlsm' || anexo.dsExtensao === 'csv'"
                                            (click)="preRemove(index);" class="fa-stack fa-md" style="color: #81c784;" title="{{anexo.dsNome}}" data-toggle="tooltip">
                                            <i class="fa fa-file-excel-o fa-3x"></i>
                                            <i class="fa fa-times fa-stack-1x icon-remove"></i>
                                        </span>
                                        <span
                                            *ngIf="anexo.dsExtensao === 'doc' || anexo.dsExtensao === 'docx' || anexo.dsExtensao === 'docm' || anexo.dsExtensao === 'txt'"
                                            (click)="preRemove(index);" class="fa-stack fa-md" style="color: #64b5f6;" title="{{anexo.dsNome}}" data-toggle="tooltip">
                                            <i class="fa fa-file-word-o fa-3x"></i>
                                            <i class="fa fa-times fa-stack-1x icon-remove"></i>
                                        </span>
                                        <span *ngIf="anexo.dsExtensao === 'rar' || anexo.dsExtensao === 'zip'" (click)="preRemove(index);" class="fa-stack fa-md"
                                            style="color: #90a4ae;" title="{{anexo.dsNome}}" data-toggle="tooltip">
                                            <i class="fa fa-file-zip-o fa-3x"></i>
                                            <i class="fa fa-times fa-stack-1x icon-remove"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="filtrosPesquisaTecnico.filtros.ocorrenciaGsm.distribuicoes && filtrosPesquisaTecnico.filtros.ocorrenciaGsm.distribuicoes.length > 0"
                                class="col-xs-12 col-sm-12 col-md-12 col-lg-12 table-responsive">
                                <h5>Distribuições</h5>
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Tipo</th>
                                            <th>Responsável</th>
                                            <th>Descrição</th>
                                            <th>Previsão de entrega</th>
                                            <th>Branch</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let dist of filtrosPesquisaTecnico.filtros.ocorrenciaGsm.distribuicoes; let i = index;" class="text-left">
                                            <td>{{i + 1}}</td>
                                            <td>{{getTipoTarefa(dist.cdTipoTarefa)}}</td>
                                            <td>{{getResponsavel(dist.cdUsuarioAtendimento)}}</td>
                                            <td>{{dist.dsComentarioTecnico}}</td>
                                            <td>{{getDataFormatada(dist.dtprevisaoEntrega)}}</td>
                                            <td>{{dist.cdBranch ? getBranch(dist.cdBranch) : '-'}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div id="tabBodyDistribuicao" class="tab-pane fade">
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                                <label for="dev1">Modalidade</label>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle form-control" type="button" id="frontEnd" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                        {{filtrosPesquisaTecnico.filtros.modalidadeDesenvolvimento.show}}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li *ngFor="let item of filtrosPesquisaTecnico.filtros.modalidades;">
                                            <a (click)="distribuicao.cdTipoTarefa = item.select; filtrosPesquisaTecnico.filtros.modalidadeDesenvolvimento = item; carregarDadosTarefa(item.select);">
                                                {{item.show}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" *ngIf="listFuncionarioTarefa && listFuncionarioTarefa.length > 0">
                                <label for="usuario">Técnico</label>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle form-control" type="button" id="usuario" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                        {{funcionarioTarefa.nome}}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li *ngFor="let item of listFuncionarioTarefa;">
                                            <a (click)="funcionarioTarefa = item; distribuicao.cdUsuarioAtendimento = item.nrDocumento;">
                                                {{item.nome}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" *ngIf="distribuicao">
                                <label for="usuario">Data Prevista para entrega</label>
                                <input type="date" class="form-control pull-left" [(ngModel)]="distribuicao.dtprevisaoEntrega" />
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" *ngIf="branches && branches.length > 0">
                                <label for="usuario">Branch</label>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle form-control" type="button" id="usuario" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                        {{branch.valor}}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li *ngFor="let item of branches;">
                                            <a (click)="branch = item; distribuicao.cdBranch = item.codigo;">
                                                {{item.valor}}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" *ngIf="distribuicao">
                                <label for="descricaoReabertura">Comentário Técnico:
                                    <span class="required-message">*&nbsp;{{reqMsgReabertura}}</span>
                                </label>
                                <textarea id="descricaoReabertura" class="form-control" rows="5" maxlength="10000" placeholder="Escreva Aqui o Comentário Técnico..."
                                    [(ngModel)]="distribuicao.dsComentarioTecnico">
                                </textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button *ngIf="!isTabDistribuicao" type="button" class="btn btn-default" data-dismiss="modal">
                    Cancelar
                </button>
                <button *ngIf="!isTabDistribuicao" type="button" class="btn btn-primary" (click)="salvarOcorrencia();">
                    Gravar
                </button>
                <button *ngIf="isTabDistribuicao" type="button" class="btn btn-success" (click)="distribuir();">
                    Adicionar Distribuição
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Reabertura-->
<div class="modal fade" id="modalReabertura" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Reabrir Ocorrência</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <label for="descricaoReabertura">Descrição:
                            <span class="required-message">*&nbsp;{{reqMsgReabertura}}</span>
                        </label>
                        <textarea id="descricaoReabertura" class="form-control" rows="10" maxlength="10000" placeholder="Escreva Aqui o Motivo..."
                            [(ngModel)]="descricaoHistorico">
                        </textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" (click)="reabrirOcorrencia();">Gravar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Cadastro de usuaŕios-->
<!-- <div class="modal fade" id="modalCadastroUsuario" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Cadastrar Novo Usuário</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <label for="cpf-cnpj">CPF/CNPJ:</label>
                        <input type="text" class="form-control pull-left" [(ngModel)]="novoUsuario.dsCpfCnpj" />
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <label for="nome">Nome:</label>
                        <input type="text" class="form-control pull-left" [(ngModel)]="novoUsuario.nome" />
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <label for="nome">E-mail:</label>
                        <input type="email" class="form-control pull-left" [(ngModel)]="novoUsuario.dsEmail" />
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                        <label for="perfil">Perfil:
                        </label>
                        <div class="dropdown">
                            <button id="produto" class="btn btn-default dropdown-toggle form-control" type="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                {{filtrosPesquisaTecnico.filtros.produto.show}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let key of filtrosPesquisaTecnico.filtros.produtos;">
                                    <a (click)="filtrosPesquisaTecnico.filtros.produto = key">
                                        {{key.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Funcionário SM?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.funcionario">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Situação?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inSituacao">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Ativo?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inAtivo">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Veterinário responsável?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inVeterinario">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Agrônomo responsável?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inAgronomo">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Focal point?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inFocalPoint">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Key user?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inKeyUser">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Gerente do Projeto?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inGerenteProjeto">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                    <strong>Fiscal do contrato?</strong>
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="novoUsuario.inFiscalContrato">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <br/>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary">Gravar</button>
            </div>
        </div>
    </div>
</div> -->

<div id="modalAlocar" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-lg modal-dialog-full-page" role="document">
        <div class="modal-content modal-content-full-page">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Alocar Técnico / Editar</h4>
            </div>
            <div class="modal-body">
                <div class="row form-group">
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                        <label for="produto">Produto:
                            <span class="required-message">*&nbsp;{{reqMsgProd}}</span>
                        </label>
                        <div class="dropdown">
                            <button id="produto" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="true">
                                {{filtros.produto.show}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let key of filtrosPesquisaTecnico.filtros.produtos;">
                                    <a (click)="ocorrenciaGsm.cdProduto = key.select; filtros.produto = key;">
                                        {{key.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                        <label for="tipoOcorrencia">Funcionalidade:
                            <span class="required-message">*&nbsp;{{reqMsgTipo}}</span>
                        </label>
                        <div class="dropdown">
                            <button id="tipoOcorrencia" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="true">
                                {{filtros.tipoOcorrencia.show}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu scrollable-menu">
                                <li *ngFor="let key of filtrosPesquisaTecnico.filtros.tiposOcorrencia;">
                                    <a (click)="ocorrenciaGsm.cdFuncionalidade = key.select; filtros.tipoOcorrencia = key;">
                                        {{key.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3" *ngIf="filtros.prioridadeUm">
                        <label for="prioridadeUm">Prioridade 1:
                            <span class="required-message">*&nbsp;{{reqMsgPrioridadeUm}}</span>
                        </label>
                        <div class="dropdown">
                            <button id="prioridadeUm" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="true">
                                {{filtros.prioridadeUm.show}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let key of filtrosPesquisaTecnico.filtros.listPrioridadeUm;">
                                    <a (click)="ocorrenciaGsm.nrPrioridade1 = key.select; filtros.prioridadeUm = key;">
                                        {{key.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3" *ngIf="filtros.prioridadeDois">
                        <label for="prioridadeDois">Prioridade 2:
                            <span class="required-message">*&nbsp;{{reqMsgPrioridadeDois}}</span>
                        </label>
                        <div class="dropdown">
                            <button id="prioridadeDois" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="true">
                                {{filtros.prioridadeDois.show}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let key of filtrosPesquisaTecnico.filtros.listPrioridadeDois;">
                                    <a (click)="ocorrenciaGsm.nrPrioridade2 = key.select; filtros.prioridadeDois = key;">
                                        {{key.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                        <label for="solicitadoCliente">Ocorrência interna?
                            <span class="required-message">*&nbsp;{{reqMsgSolicitado}}</span>
                        </label>
                        <div class="dropdown">
                            <button id="solicitadoCliente" class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="true">
                                {{comboOcorrenciaInterna}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let key of simNao;">
                                    <a (click)="ocorrenciaGsm.inOcorrenciaInterna = key.select; comboOcorrenciaInterna = key.show;">
                                        {{key.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!-- daqui pra baixo vai ser pro usuario da sm -->
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                        <label for="dataSolicitacao">Data da solicitação:
                            <span class="required-message">*&nbsp;{{reqMsgTipo}}</span>
                        </label>
                        <div class="dropdown">
                            <input id="dataSolicitacao" class="form-control" type="date" [(ngModel)]="ocorrencia.dtAbertura">
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                        <label for="usuario">Técnico</label>
                        <div class="dropdown">
                            <button class="btn btn-default dropdown-toggle form-control" type="button" id="usuario" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="true">
                                {{filtros.desenvolvedorSm.show}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let item of  filtrosPesquisaTecnico.filtros.listUsuarioSm;">
                                    <a (click)="ocorrenciaGsm.cdUsuarioSolicitante = item.nrDocumento; setUsuarioSmFiltro(item);">
                                        {{item?.nome}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-3">
                        <label for="backEndBanco">Status:
                            <span class="required-message">*&nbsp;{{reqMsgStatus}}</span>
                        </label>
                        <div class="dropdown">
                            <button class="btn btn-default dropdown-toggle form-control" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                {{labelStatusOcorrencia}}
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li *ngFor="let item of filtrosPesquisaTecnico.filtros.listStatusTemp;">
                                    <a (click)="setStatusOcorrencia(item);">
                                        {{item.show}}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <br/>
                        <button type="button" class="btn btn-success btn-sm pull-left" data-toggle="modal" data-target="#modalDistribuicao" (click)="novaDistribuicao();">
                            <i class="fa fa-plus"></i>&nbsp;Adicionar Distribuição
                        </button>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Tipo</th>
                                    <th>Responsável</th>
                                    <th>Descrição</th>
                                    <th>Previsão de entrega</th>
                                    <th>Branch</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let dist of ocorrenciaGsm.distribuicoes; let i = index;" class="text-left">
                                    <td>{{i + 1}}</td>
                                    <td>{{getTipoTarefa(dist.cdTipoTarefa)}}</td>
                                    <td>{{getResponsavel(dist.cdUsuarioAtendimento)}}</td>
                                    <td>{{dist.dsComentarioTecnico}}</td>
                                    <td>{{getDataFormatada(dist.dtprevisaoEntrega)}}</td>
                                    <td>{{dist.cdBranch ? getBranch(dist.cdBranch) : '-'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer footer-full-page">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" (click)="gravarDistribuicao();">Gravar</button>
            </div>
        </div>
    </div>
</div>

</ion-content>
